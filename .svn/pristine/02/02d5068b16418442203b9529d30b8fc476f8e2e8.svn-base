<%@ page language="java" contentType="text/html; charset=UTF-8"  pageEncoding="UTF-8"%>
<%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<%@ taglib prefix="sec" uri="http://www.springframework.org/security/tags"%>
<style>
.rowPriority{
	color: orange;
	font-size: 1.2em;

}
.highPriority{
	color: green;
	font-size: 1.2em;
}

.offcanvas-end {
    width: 550px;
}
.icon{
	display: inline-block;
	width: 20px;
	text-align: center;
}
.membtn{
	margin-right: 5px;
	margin-top: 5px;
}
.app-search{
	padding: 0px;
}
.dateLabel{
	font-size: 0.8em;
}
.fa-clock{
	margin-top: 20px;
}

</style>

<div class="row">
	<div class="col-lg-12">
		<div class="card">
			<div class="card-body">
			
				<%@ include file="includeTab.jsp" %>
					                      
               	<div class="row">
               	
					<div class="col-lg-2">
						<%@ include file="includeSide.jsp" %>	
					</div> <!-- col end -->
					
					<div class="col-lg-9 ">
						<div class="row">
<!-- 							<div class="col-2 alert alert-primary" role="alert"> -->
<!-- 								  ÏµúÏÜå Ìïú Í∞ú  -->
<!-- 							</div> -->
							<div class="col-4">
                                <form class="app-search d-none d-lg-block">
		                            <div class="position-relative">
		                                <input type="text" class="form-control" placeholder="Search...">
		                                <span class="ri-search-line"></span>
		                            </div>
                        		</form>
                            </div>	
							<div class="col-6">
								<button type="button" id="insertWorkBtn" class="btn btn-dark btn-rounded waves-effect waves-light">
									ÏóÖÎ¨¥Ï∂îÍ∞Ä
								</button>
							</div>
						</div><!-- row end -->
						
						<div class="row">
							<div class="table">
	                            <table id="selection-datatable" class="table dt-responsive nowrap w-100">
	                                <thead>
	                                    <tr>
	                                        <th>Î≤àÌò∏</th>
	                                        <th>ÏÉÅÌÉú</th>
	                                        <th>Ïö∞ÏÑ†ÏàúÏúÑ</th>
	                                        <th>ÏóÖÎ¨¥ÎÇ¥Ïö©</th>
	                                        <th>Îã¥ÎãπÏûê</th>
	                                        <th>ÏàòÏ†ïÏùºÏãú</th>
	                                    </tr>
	                                </thead>
	                                <tbody id="tbody">
									
	                                  	
	                            
	                                </tbody>
	                            </table>
	                        
	                        </div> <!-- end table-->
							
						</div><!-- row end -->
						
					</div> <!-- col end -->
					
            	</div><!-- end row-->
			</div> <!-- end card body-->
		</div> <!-- end card -->
	</div>
</div>
		
<!-- 	<div class="alert alert-primary alert-dismissible fade" role="alert"> -->
<!-- 		<font style="vertical-align: inherit;"> -->
<!-- 			<font style="vertical-align: inherit;"> -->
<!--         	ÏµúÏÜå Ìïú Í∞ú Ïù¥ÏÉÅ Ï≤¥ÌÅ¨ÌïòÏÑ∏Ïöî! -->
<!--         	</font> -->
<!--         </font> -->
<!--         <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Îã´Í∏∞"> -->
<!--         </button> -->
<!--     </div> -->
	

	
	<!-- Modal -->
	<div class="modal" id="insertWorkModal" tabindex="-1">
		<div class="modal-dialog" >
			<div class="modal-content">
				<form:form modelAttribute="projWorkVO" method="POST" action="/project/insertWork" enctype="multipart/form-data">
					<div class="modal-header">
						<h5 class="modal-title">ÏóÖÎ¨¥Ï∂îÍ∞Ä</h5>
						
						<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
					</div>
					<div class="modal-body">
							<form:hidden path="projId" value="${projWorkVO.projId }"/>						
							<form:hidden path="workRqstr" value="EMPL00004"/>		
<%-- 							<sec:authentication property="principal.username"/>				 --%>
						<div class="row p-3">
							<form:input class="form-control form-control-lg" path="workTitle" placeholder="Ï†úÎ™©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" />						
						</div>
						<div class="p-3">
							<form:hidden path="workState" />						
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn">ÏöîÏ≤≠</button>						
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn">ÏßÑÌñâ</button>						
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn">ÏôÑÎ£å</button>						
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn">Ïù¥Ïäà</button>						
						</div>
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-user-alt fa-2x "></i>
								</div>
								<div class="col-9 dropdown">
									<div class="col-auto"> 	
									
									  <button class="btn btn-outline-secondary waves-effect dropdown-toggle" type="button" id="dropMember" data-bs-toggle="dropdown" aria-expanded="false">
									    Îã¥ÎãπÏûê
									  </button>
									<ul class="dropdown-menu" aria-labelledby="dropMember">
									 	<c:forEach var="empVO" items="${list }">
										<li><a class="dropdown-item projmem" href="#" empId="${empVO.empId }">${empVO.empName }</a></li>
										</c:forEach>
									</ul>
									</div>
									<div id="memDiv" class="col-auto"> </div>
								</div> 
							</div>
						</div> 
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-clock fa-2x "></i>
								</div>
								<div class="col-10">
									<label for="workStrtDt" class="dateLabel">ÏãúÏûëÏùºÏûê</label>
									<form:input class="form-control" path="workStrtDt" type="date" />						
								
								</div>
							</div>
						</div>
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-clock fa-2x "></i>
								</div>
								<div class="col-10">
									<label for="workEndDt" class="dateLabel">ÎßàÍ∞êÏùºÏûê</label>
									<form:input class="form-control" path="workEndDt" type="date" />						
								</div>
							</div>
						</div>
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-flag fa-2x "></i>
								</div>
								<div class="col-10 dropdown">
									<form:hidden path="workPriority" />						
									<button class="btn btn-outline-secondary waves-effect dropdown-toggle" type="button" id="dropPriority" data-bs-toggle="dropdown" aria-expanded="false">
									    ÏóÖÎ¨¥ÏàúÏúÑ
									 </button>
									<ul class="dropdown-menu" aria-labelledby="dropPriority">
										<li><a class="dropdown-item priorityBtn" href="#" priority = "ÎÇÆÏùå" ><i class="fa fa-arrow-down icon"  style="color:orange"></i>ÎÇÆÏùå</a></li>
										<li><a class="dropdown-item priorityBtn" href="#" priority = "Î≥¥ÌÜµ"><span class="icon">‚ûñ</span>Î≥¥ÌÜµ</a></li>
										<li><a class="dropdown-item priorityBtn" href="#" priority = "ÎÜíÏùå" ><i class="fa fa-arrow-up icon"  style="color:green"></i>ÎÜíÏùå</a></li>
										<li><a class="dropdown-item priorityBtn" href="#" priority = "Í∏¥Í∏â" ><span class="icon">üö®</span>Í∏¥Í∏â</a></li>
									</ul>
								</div>    
							
							</div>
						</div>
						
						<div class="p-3">
							<form:textarea path="workCntnt" class="form-control"  rows="5" placeholder="ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" />
						</div>
						
						<div class="p-3">
							<input type="file" class="form-control" name="uploadFile" multiple />
						</div>
						
					</div>
					
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">Ï∑®ÏÜå</button>
						<button type="submit" id="okBtn" class="btn btn-primary">ÌôïÏù∏</button>
					</div>
					<sec:csrfInput/>
				</form:form>	
			</div>
		</div>
	</div>
	

     <!-- right offcanvas -->
     <div class="offcanvas offcanvas-end" tabindex="-1" id="wokrDetail" aria-labelledby="wokrDetailLabel">
         <div class="offcanvas-header">
           <h5 id="wokrDetailLabel">ÏóÖÎ¨¥Ï†úÎ™©</h5>
           <div class="col-2">
           <a href="#" id="editBtn" class="text-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="Edit"><i class="mdi mdi-pencil font-size-18"></i></a>
           <a href="#" id="delBtn" class="text-danger" data-bs-toggle="tooltip" data-bs-placement="top" title="Delete"><i class="mdi mdi-trash-can font-size-18"></i></a>
           
           <button type="button" class="btn-close text-reset" data-bs-dismiss="offcanvas" aria-label="Close"></button>
           </div>
         </div>
         <div class="offcanvas-body">
           		<form:form modelAttribute="projWorkVO" method="POST" action="/project/">
							<form:hidden path="projId" value="${projWorkVO.projId }"/>						
							<form:hidden path="workRqstr" value="EMPL00004"/>		
<!-- 					<div class="p-3"> -->
<%-- 						<form:input path="workCntnt" class="form-control"  rows="5" placeholder="ÎÇ¥Ïö©ÏùÑ ÏûÖÎ†•ÌïòÏÑ∏Ïöî" />  --%>
<!-- 					</div> -->
					<div class="p-3">
						<form:textarea path="workCntnt" class="form-control"  rows="5" placeholder="" />
					</div>
						<div class="p-3">
							<form:hidden path="workState" />					
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn" id="request">ÏöîÏ≤≠</button>						
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn" id="ing">ÏßÑÌñâ</button>						
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn" id="complete">ÏôÑÎ£å</button>						
							<button type="button" class="btn btn-secondary btn-rounded waves-effect wkStateBtn" id="issue">Ïù¥Ïäà</button>						
						</div>
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-user-alt fa-2x "></i>
								</div>
								<div class="col-9 dropdown">
									<div class="col-auto"> 	
									
									  <button class="btn btn-outline-secondary waves-effect dropdown-toggle" type="button" id="dropMember" data-bs-toggle="dropdown" aria-expanded="false">
									    Îã¥ÎãπÏûê
									  </button>
									<ul class="dropdown-menu" aria-labelledby="dropMember">
									 	<c:forEach var="empVO" items="${list }">
										<li><a class="dropdown-item projmem" href="#" empId="${empVO.empId }">${empVO.empName }</a></li>
										</c:forEach>
									</ul>
									</div>
									<div id="memDiv" class="col-auto"> </div>
								</div> 
							</div>
						</div> 
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-clock fa-2x "></i>
								</div>
								<div class="col-10">
									<label for="workStrtDt" class="dateLabel">ÏãúÏûëÏùºÏûê</label>
									<input type="hidden" class="form-control" name="oldWorkStrtDt" type="date" />						
									<form:input class="form-control" path="workStrtDt" type="date" />
								</div>
							</div>
						</div>
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-clock fa-2x "></i>
								</div>
								<div class="col-10">
									<label for="workEndDt" class="dateLabel">ÎßàÍ∞êÏùºÏûê</label>
									<input type="hidden" class="form-control" name="oldWorkStrtDt" type="date" />						
									<form:input class="form-control" path="workEndDt" type="date" />						
								</div>
							</div>
						</div>
						
						<div class="p-3">
							<div class="row">
								<div class="col-2">
									<i class="fas fa-flag fa-2x "></i>
								</div>
								<div class="col-10 dropdown">
									<form:hidden path="workPriority" />						
									<button class="btn btn-outline-secondary waves-effect dropdown-toggle" type="button" id="dropPriority" data-bs-toggle="dropdown" aria-expanded="false">
									    ÏóÖÎ¨¥ÏàúÏúÑ
									 </button>
									<ul class="dropdown-menu" aria-labelledby="dropPriority">
										<li><a class="dropdown-item priorityBtn" href="#" priority = "ÎÇÆÏùå" ><i class="fa fa-arrow-down icon"  style="color:orange"></i>ÎÇÆÏùå</a></li>
										<li><a class="dropdown-item priorityBtn" href="#" priority = "Î≥¥ÌÜµ"><span class="icon">‚ûñ</span>Î≥¥ÌÜµ</a></li>
										<li><a class="dropdown-item priorityBtn" href="#" priority = "ÎÜíÏùå" ><i class="fa fa-arrow-up icon"  style="color:green"></i>ÎÜíÏùå</a></li>
										<li><a class="dropdown-item priorityBtn" href="#" priority = "Í∏¥Í∏â" ><span class="icon">üö®</span>Í∏¥Í∏â</a></li>
									</ul>
								</div>    
							
							</div>
						</div>
					
<!-- 					<div class="modal-footer"> -->
<!-- 						<button type="button" class="btn btn-secondary" -->
<!-- 							data-bs-dismiss="modal">Ï∑®ÏÜå</button> -->
<!-- 						<button type="submit" id="okBtn" class="btn btn-primary">ÌôïÏù∏</button> -->
<!-- 					</div> -->
					<sec:csrfInput/>
				</form:form>
         </div>
     </div>
	
<script type="text/javascript">
// function datailCilck(){
// 	console.log();
// }

function toStringByFormat(date) { 
	var year = date.getFullYear();
	var month = ('0' + (date.getMonth() + 1)).slice(-2);
	var day = ('0' + date.getDate()).slice(-2);

	var dateString = year + '-' + month  + '-' + day;
	
	return dateString;
}
	
function removeClass(p_obj, p_list){
// 	console.log(p_obj);
	for(var i=0; i<p_list.length; i++){
		$(p_obj).removeClass(p_list[i]);
// 		console.log(p_list[i]);
	}
}	

function wkStateBtnClick(p_btn){
	var wkState = $(p_btn).text();
	var removeList = ["btn-info", "btn-success", "btn-dark", "btn-danger"];
	removeClass(".wkStateBtn", removeList);

	$(".wkStateBtn").addClass("btn-secondary"); 
	
	if(wkState=="ÏöîÏ≤≠"){
	$(p_btn).addClass("btn-info");
	}
	if(wkState=="ÏßÑÌñâ"){
	$(p_btn).addClass("btn-success");
	}
	if(wkState=="ÏôÑÎ£å"){
	$(p_btn).addClass("btn-dark");
	}
	if(wkState=="Ïù¥Ïäà"){
	$(p_btn).addClass("btn-danger");
	}
	
	$("#workState").val(wkState);
}

function priorityBtnClick(p_btn){
	var priority = $(p_btn).attr("priority")
	
	var priorityBtn = $(p_btn).parents('.dropdown').find("#dropPriority");
	
	
	var removeList = ["btn-outline-secondary", "btn-outline-warning", "btn-outline-dark", "btn-outline-success", "btn-outline-danger"];
	removeClass(priorityBtn, removeList)

	
	var code = "";
	if(priority=="ÎÇÆÏùå"){
		code += '<i class="fa fa-arrow-down icon" style="color:orange"></i>ÎÇÆÏùå'; 	
		priorityBtn.html(code);
		priorityBtn.addClass("btn-outline-warning"); 
	}
	if(priority=="Î≥¥ÌÜµ"){
		priorityBtn.text($(p_btn).text());
		priorityBtn.addClass("btn-outline-dark"); 
		
	}
	if(priority=="ÎÜíÏùå"){
			
		code += '<i class="fa fa-arrow-down icon" style="color:green"></i>ÎÜíÏùå'; 	
		priorityBtn.html(code);
		
		priorityBtn.addClass("btn-outline-success"); 
		
	}
	if(priority=="Í∏¥Í∏â"){
		priorityBtn.text($(p_btn).text());
		priorityBtn.addClass("btn-outline-danger"); 
			
	}
	
	$(this).parents('.dropdown').find('input[name=workPriority]').val(priority);

// 	$("input[name='workPriority']").val(priority);
}
$(function(){
	// var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'))
	// var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
	//   return new bootstrap.Tooltip(tooltipTriggerEl)
	// })
// 	$('[data-toggle="tooltip"]').tooltip();   

	// ajax Post ÏÇ¨Ïö©Ïãú Í∞ôÏù¥ Î≥¥ÎÇº ÌÜ†ÌÅ∞Ìó§Îçî 
	var token = '${_csrf.token}'
	var header = '${_csrf.headerName}'
	
	// Î¶¨Ïä§Ìä∏ Í∞ÄÏ†∏Ïò§Í∏∞
	workList();
	 
	// ÏóÖÎ¨¥Ï∂îÍ∞Ä Î≤ÑÌäº ÌÅ¥Î¶≠Ïãú Î™®Îã¨ Î≥¥Ïó¨Ïßê
	$("#insertWorkBtn").on("click", function(){
		$("#insertWorkModal").modal("show");
		
		$("#memDiv").empty();
	})
	
	// ------------Î™®Îã¨ÏïàÏóêÏÑú Ïù¥Î≤§Ìä∏---------------
	// Îã¥ÎãπÏûê ÌÅ¥Î¶≠Ïãú Ìï¥Îãπ Îã¥ÎãπÏûê Ï∂îÍ∞ÄÎê® 
	$(".projmem").on("click", function(){
		var memlist = [];
		memlist = $(".membtn");
		
		// Ï§ëÎ≥µÏù¥Î¶Ñ ÏÑ†ÌÉùÏãú Î¶¨ÌÑ¥
		for(var i=0; i<memlist.length; i++){
			if($(this).text()==memlist[i].innerText){
				return false;
			}
		}
		
		// Ïù¥Î¶ÑÎì§Ïñ¥Í∞Ñ Î≤ÑÌäº ÎßåÎì§Í∏∞
		var btn = "<button type='button' class='btn btn-outline-info waves-effect waves-light membtn'>";
		btn += "<i class='ri-close-line align-middle me-2'></i>";
		btn += $(this).text();
		btn += "</button>";
		// ÏÑ†ÌÉùÌïú Ïù¥Î¶Ñ VOÏóê Îì§Ïñ¥Í∞à Ïàò ÏûàÍ≤å ÌûàÎì†ÏúºÎ°ú ÎÑ£Ïñ¥ÎÜìÍ∏∞
		btn += '<input id="workMngr" name="workMngr" value="'+$(this).attr("empId")+'" type="hidden">';
		
		$("#memDiv").append(btn);
		
	})
	
	// Ï∂îÍ∞ÄÎêú Îã¥ÎãπÏûêÎ≤ÑÌäºÏóê ÏûàÎäî xÌÅ¥Î¶≠Ïãú Îã¥ÎãπÏûê ÏÇ≠Ï†úÎê®
	$(document).on("click","#insertWorkModal .ri-close-line", function(){
// 		console.log($(this).parents(".btn"));
		$(this).parents(".btn").remove();
	})
	
	// ÏóÖÎ¨¥Ïö∞ÏÑ†ÎèÑ ÌÅ¥Î¶≠Ïãú 
	$("#insertWorkModal .priorityBtn").on("click", function(){
// 		console.log($(this).attr("priority"));
		priorityBtnClick(this);
// 		$(this).parents('.dropdown').find('input[name=workPriority]').val(priority);
		
	})
	
	// ÏóÖÎ¨¥ÏÉÅÌÉú Î≤ÑÌäº ÌÅ¥Î¶≠Ïãú 
	$("#insertWorkModal .wkStateBtn").on("click", function(){
		wkStateBtnClick(this);

	})
	// ------------Î™®Îã¨ÏïàÏóêÏÑú Ïù¥Î≤§Ìä∏ ÎÅù---------------
// 	console.log(priorityList);
// 	console.log(wkStateList);
	
	// ÏÇ¨Ïù¥ÎìúÌÉ≠ ÌÅ¥Î¶≠Ïãú 
	$(".sideBox").on("click", function(){
		workList();
		
	})
	
	// ------------ÎîîÌÖåÏùº ÌÅ¥Î¶≠Ïãú Ïù¥Î≤§Ìä∏---------------
	$(document).on("click",".wkDetail", function(){
		console.log("wkDetail test");
		var workId = $(this).children(".workId").text();
		console.log(workId);
		
		
		$.ajax({
			url: "/project/workDetail",
			type: "POST",
			dataType: "json",
			data: {
				'workId' : workId		
			},
			success: function(res) {
				console.log(res);
				// Ï†úÎ™©
				$("#wokrDetailLabel").text(res.workTitle);			
				// ÎÇ¥Ïö©
				$("#wokrDetail #workCntnt").text(res.workCntnt);
				// ÏÉÅÌÉú
				var removeList = ["btn-info", "btn-success", "btn-dark", "btn-danger"];
				removeClass(".wkStateBtn", removeList);
				
				if(res.workState=="ÏöîÏ≤≠"){
					$("#wokrDetail #request").addClass("btn-info");
				}
				if(res.workState=="ÏßÑÌñâ"){
					$("#wokrDetail #ing").addClass("btn-success");
				}
				if(res.workState=="ÏôÑÎ£å"){
					$("#wokrDetail #complete").addClass("btn-dark");
				}
				if(res.workState=="Ïù¥Ïäà"){
					$("#wokrDetail #issue").addClass("btn-danger");
				}
				
// 				wkStateBtnClick($("#workDetail "))
				
				
				// Îã¥ÎãπÏûê
				$("#wokrDetail #memDiv").empty()
				for(var i=0; i<res.workMngr.length; i++){
					
					// Ïù¥Î¶ÑÎì§Ïñ¥Í∞Ñ Î≤ÑÌäº ÎßåÎì§Í∏∞
					var btn = "<button type='button' class='btn btn-outline-info waves-effect waves-light membtn'>";
					btn += "<i class='ri-close-line align-middle me-2'></i>";
					btn += res.workMngr[i];
					btn += "</button>";
					// ÏÑ†ÌÉùÌïú Ïù¥Î¶Ñ VOÏóê Îì§Ïñ¥Í∞à Ïàò ÏûàÍ≤å ÌûàÎì†ÏúºÎ°ú ÎÑ£Ïñ¥ÎÜìÍ∏∞
					btn += '<input id="workMngr" name="workMngr" value="'+ res.workMngr[i] +'" type="hidden">';
					
					$("#wokrDetail #memDiv").append(btn);
				}
				
				// ÎÇ†Ïßú
				var workStrtDt = toStringByFormat(new Date(res.workStrtDt))
				var workEndDt = toStringByFormat(new Date(res.workEndDt))
				$("#wokrDetail input[name=oldWorkStrtDt]").val(workStrtDt);
				$("#wokrDetail #workStrtDt").val(workStrtDt);
				$("#wokrDetail #workEndDt").val(workEndDt);
				
				// ÏóÖÎ¨¥ÏàúÏúÑ
				var removeList = ["btn-outline-secondary", "btn-outline-warning", "btn-outline-dark", "btn-outline-success", "btn-outline-danger"];
				removeClass("#wokrDetail #dropPriority", removeList)
				
				code = "";
				if(res.workPriority=="ÎÇÆÏùå"){
					code += '<i class="fa fa-arrow-down icon" style="color:orange"></i>ÎÇÆÏùå'; 
					$("#wokrDetail #dropPriority").addClass("btn-outline-warning"); 
				}
				if(res.workPriority=="Î≥¥ÌÜµ"){
					code += '<span class="icon">‚ûñ</span>Î≥¥ÌÜµ'; 	
					$("#wokrDetail #dropPriority").addClass("btn-outline-dark"); 
					
				}
				if(res.workPriority=="ÎÜíÏùå"){
						
					code += '<i class="fa fa-arrow-down icon" style="color:green"></i>ÎÜíÏùå'; 	
					$("#wokrDetail #dropPriority").addClass("btn-outline-success"); 
					
				}
				if(res.workPriority=="Í∏¥Í∏â"){
					code += '<span class="icon">üö®</span>Í∏¥Í∏â'; 	
					$("#wokrDetail #dropPriority").addClass("btn-outline-danger"); 
						
				}
					$("#wokrDetail #dropPriority").html(code);
				
				
						
			},
			beforeSend:function(xhr) { 
				xhr.setRequestHeader(header, token)
			},
			error: function(xhr) {
				alert(xhr.status)
			
			}
		})
		
	})
	
	// ------------ÎîîÌÖåÏùº ÌÅ¥Î¶≠Ïãú Ïù¥Î≤§Ìä∏ ÎÅù---------------
	
	// ------------ÎîîÌÖåÏùº Ï∞Ω ÏïàÏóê Îç∞Ïù¥ÌÑ∞ ÌÅ¥Î¶≠Ïãú Ïù¥Î≤§Ìä∏ ----------
	// ÏÉÅÌÉúÎ≤ÑÌäº ÌÅ¥Î¶≠Ïãú
	$("#wokrDetail .wkStateBtn").on("click", function(){
		Swal.fire(
				{ title: 'ÏÉÅÌÉúÎ•º Î≥ÄÍ≤ΩÌïòÏãúÍ≤†ÏäµÎãàÍπå?'
// 						, text: "Îã§Ïãú ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§. Ïã†Ï§ëÌïòÏÑ∏Ïöî."
						, icon: 'warning', showCancelButton: true
						, confirmButtonColor: '#3085d6'
						, cancelButtonColor: '#d33'
						, confirmButtonText: 'ÌôïÏù∏'
						, cancelButtonText: 'Ï∑®ÏÜå' 
				}).then((result) => { 
						if (result.isConfirmed) { 
							Swal.fire( '', 'ÏÉÅÌÉúÍ∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.', 'success' ) 
							wkStateBtnClick(this);
						} 
				})
        	
	})	
	
	// Îã¥ÎãπÏûê XÌÅ¥Î¶≠Ïãú
	$(document).on("click", "#wokrDetail .ri-close-line", function(){
		Swal.fire(
				{ title: 'Îã¥ÎãπÏûêÎ•º ÏÇ≠Ï†úÌïòÏãúÍ≤†ÏäµÎãàÍπå?'
// 						, text: "Îã§Ïãú ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§. Ïã†Ï§ëÌïòÏÑ∏Ïöî."
						, icon: 'warning', showCancelButton: true
						, confirmButtonColor: '#3085d6'
						, cancelButtonColor: '#d33'
						, confirmButtonText: 'ÌôïÏù∏'
						, cancelButtonText: 'Ï∑®ÏÜå' 
				}).then((result) => { 
						if (result.isConfirmed) { 
							$(this).parents(".btn").remove();
						} 
				})
        	
	})	
	// ÎÇ†ÏßúÎ≤ÑÌäº ÌÅ¥Î¶≠Ïãú
	$("#wokrDetail #workStrtDt").on('focusin', function(){
	    console.log("Saving value " + $(this).val());
	    $(this).data('old', $(this).val());
	});
	
	$("#wokrDetail #workStrtDt").on("change", function(){
// 		alert($("#wokrDetail input[name=oldWorkStrtDt]").val());
		oldvalue =  $(this).data('old');
		Swal.fire(
				{ title: 'ÏÉÅÌÉúÎ•º Î≥ÄÍ≤ΩÌïòÏãúÍ≤†ÏäµÎãàÍπå?'
// 						, text: "Îã§Ïãú ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§. Ïã†Ï§ëÌïòÏÑ∏Ïöî."
						, icon: 'warning', showCancelButton: true
						, confirmButtonColor: '#3085d6'
						, cancelButtonColor: '#d33'
						, confirmButtonText: 'ÌôïÏù∏'
						, cancelButtonText: 'Ï∑®ÏÜå' 
				}).then((result) => { 
						if (!result.isConfirmed) { 
// 							Swal.fire( '', 'ÏÉÅÌÉúÍ∞Ä Î≥ÄÍ≤ΩÎêòÏóàÏäµÎãàÎã§.', 'success' ) 
							$(this).val(oldvalue);
						} 
				})
        	
	})
	
	// ÏóÖÎ¨¥Ïö∞ÏÑ†ÎèÑ ÌÅ¥Î¶≠Ïãú 
	$("#wokrDetail .priorityBtn").on("click", function(){
		Swal.fire(
				{ title: 'ÏóÖÎ¨¥ Ïö∞ÏÑ†ÎèÑÎ•º Î∞îÍæ∏ÏãúÍ≤†ÏäµÎãàÍπå?'
// 						, text: "Îã§Ïãú ÎêòÎèåÎ¶¥ Ïàò ÏóÜÏäµÎãàÎã§. Ïã†Ï§ëÌïòÏÑ∏Ïöî."
						, icon: 'warning', showCancelButton: true
						, confirmButtonColor: '#3085d6'
						, cancelButtonColor: '#d33'
						, confirmButtonText: 'ÌôïÏù∏'
						, cancelButtonText: 'Ï∑®ÏÜå' 
				}).then((result) => { 
						if (result.isConfirmed) { 
							priorityBtnClick(this);
						} 
				})
		
	})
	
	// ÏàòÏ†ïÎ≤ÑÌäº ÌÅ¥Î¶≠Ïãú 
	$("#wokrDetail #editBtn").on("click", function(){
		
		
	})
	
	// ------------ÎîîÌÖåÏùº Ï∞Ω ÏïàÏóê Îç∞Ïù¥ÌÑ∞ ÌÅ¥Î¶≠Ïãú Ïù¥Î≤§Ìä∏ ÎÅù----------

	
	function workList(){
		
//		console.log($(this).val());
//		division = $(this).val();`
		var division = $("input[name='division']:checked").val();
//	 	console.log(division);
		
		var wkStateObj = $("input[name='wkState']:checked");
//	 	console.log(wkStateObj);
		
		var priorityObj = $("input[name='priority']:checked");
//	 	console.log(priorityObj);

		if(wkStateObj.length < 1 || priorityObj.length < 1){
			alert("ÏµúÏÜå Ìïú Í∞ú Ïù¥ÏÉÅ ÏÑ†ÌÉùÌïòÏÑ∏Ïöî!")
			event.preventDefault()
			return false;
		}
		
		var wkStateList = []; 
		for(var i=0; i<wkStateObj.length; i++){
//	 		console.log(wkStateObj[i].value);
			wkStateList.push(wkStateObj[i].value)
		}
		
		var priorityList= []; 
		for(var i=0; i<priorityObj.length; i++){
//	 		console.log(wkStateObj[i].value);
			priorityList.push(priorityObj[i].value)
		}
		
		$.ajax({
			url: "/project/select",
			type: "POST",
			contentType : "application/json; charset=utf-8",
			data: JSON.stringify({'empId' : "EMPL00004"
				,'projId' : "${projWorkVO.projId}"
				,'division' : division
				,'wkStateList' : wkStateList
				,'priorityList' : priorityList
			}),
			success: function(res) {
//					console.log(res);

				var tbody = "";
				$.each(res, function(i, v) {
					
//						var workId = "'" + v.workId + "'";
					tbody += '<tr class="wkDetail" data-bs-toggle="offcanvas" data-bs-target="#wokrDetail" aria-controls="wokrDetail" >';
					tbody += '<td class="workId" >'+v.workId+'</td>';
					tbody += '<td>';
					if(v.workState==null){
						tbody += '-';
					}
					if(v.workState=="ÏöîÏ≤≠"){
						tbody += '<button type="button" class="btn btn-sm btn-info btn-rounded waves-effect ">'+v.workState +'</button>';
					}
					if(v.workState=="ÏßÑÌñâ"){
						tbody += '<button type="button" class="btn btn-sm btn-success btn-rounded waves-effect ">'+v.workState +'</button>';
					}
					if(v.workState=="ÏôÑÎ£å"){
						tbody += '<button type="button" class="btn btn-sm btn-dark btn-rounded waves-effect ">'+v.workState +'</button>';
					}
					if(v.workState=="Ïù¥Ïäà"){
						tbody += '<button type="button" class="btn btn-sm btn-danger btn-rounded waves-effect ">'+v.workState +'</button>';
					}
					tbody += '</td>';
					
					// ÏàúÏúÑ
					if(v.workPriority==null){
						tbody += '<td>-</td>';
					}else{
		                tbody += '<td>';
						
						if(v.workPriority=="ÎÇÆÏùå"){
							tbody += '<i class="fa fa-arrow-down icon" style="color:orange"></i>ÎÇÆÏùå'; 	
						}
						if(v.workPriority=="Î≥¥ÌÜµ"){
							tbody += '<span class="icon">‚ûñ</span>Î≥¥ÌÜµ'; 	
							
						}
						if(v.workPriority=="ÎÜíÏùå"){
							tbody += '<i class="fa fa-arrow-down icon" style="color:green"></i>ÎÜíÏùå'; 	
							
						}
						if(v.workPriority=="Í∏¥Í∏â"){
							tbody += '<span class="icon">üö®</span>Í∏¥Í∏â'; 	
								
						}
		                tbody += '</td>';
					}   
					
	                tbody += '<td>'+v.workTitle +'</td>';

	                if(v.workMngr.length == 1){
		                tbody += '<td><a href="javascript:void(0);" class="text-primary" data-bs-toggle="tooltip" data-bs-placement="top" title="Edit">' + v.workMngr[0] + '</a></td>';
	                }else if(v.workMngr.length > 1){
		                tbody += '<td data-toggle="tooltip" data-placement="top" title="Tooltip on top">' + v.workMngr[0] + 'Ïô∏ '+ (v.workMngr.length-1) +'Î™Ö </td>';
	                }else{
	                	tbody += '<td> - </td>';
	                	
	                }
	                
	                tbody += '<td>'+ toStringByFormat(new Date(v.workMdfyDt)) +'</td>';
	                tbody += '</tr>';
	                
	            
				})
				
				$("#tbody").html(tbody);
				
			},
			error: function(xhr) {
				alert(xhr.status)

			},
			beforeSend:function(xhr) { 
				xhr.setRequestHeader(header, token)
			},
			dataType: "json"
		})
	}	
	
	
})
</script>

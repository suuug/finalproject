<%@ page language="java" contentType="text/html; charset=UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="sec"
	uri="http://www.springframework.org/security/tags"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>

<div class="page-content">
	<div class="container-fluid">

		<!-- start page title -->
		<div class="col-12">
			<div
				class="page-title-box d-flex align-items-center justify-content-between">
				<a href="/notice/list"><h2>공지사항</h2></a>
			</div>
		</div>
		<div class="card">
			<div class="card-body">
				<div class="table-responsive">
					<table class="table mb-0">

						<tr>
							<td style="width: 80px;">작성자 : ${boardVO.brdWrtr }</td>
							<td style="width: 130px;">작성일 : <fmt:formatDate
									value="${boardVO.brdWrtDt }" pattern="yyyy/MM/dd" /></td>
							<td style="width: 130px;">수정일 : <fmt:formatDate
									value="${boardVO.brdMdfyDt }" pattern="yyyy/MM/dd" /></td>
							<td style="width: 100px;">조회수 : ${boardVO.brdHit }</td>
						</tr>
						<tr>
							<td colspan="4" style="width: 250px;"><br>
								<h4>${boardVO.brdTitle }</h4>
								<hr> <br> ${boardVO.brdCntnt }
								<p></td>
						</tr>
					</table>
				</div>
			</div>


		</div>
		<div class="col-lg-12">
			<div class="card">
				<div class="card-body">
					<h4 class="card-title">첨부된 파일</h4>
					<br>

					<div class="input-group">
						<table class="table">
							<thead class="thead-light">
								<c:forEach items="${files}" var="file" varStatus="idx" step="1">
									<tr onclick='downloadFile("${file.atchRelId}")'>
										<td class="table-font-center">${file.atchRelId}</td>
									</tr>
								</c:forEach>
							</thead>
						</table>
					</div>

				</div>
			</div>
		</div>
		<div class="col-lg-12 py-5" align="right">
			<a href="/notice/update?brdId=${param.brdId}" id="btnEdit"
				class="btn btn-secondary btn-icon-split">수정</a> 
			<a href="/notice/delete?brdId=${param.brdId}"
				id="btnDelete" class="btn btn-secondary btn-icon-split">삭제</a> 
			<a href="/notice/list?currentPage=${currentPage}"
				class="btn btn-danger btn-user">목록보기</a>
		</div>
	</div>
</div>

<script>
	function downloadFile(filename) {
		const encFileName = encodeURI(filename);
		$.ajax({
			method : "GET",
			url : `fileDownLoad.do`,
			success : function(data) {
				window.location = `fileDownLoad.do?FileName=${encFileName}`;
			},
			error : function(request, status) {
				alert("오류가 발생했습니다.");
			}
		});
	}
</script>